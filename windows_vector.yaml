#running : C:\Program Files\Vector>vector --config config\vector.yaml

data_dir: 'C:\Program Files\Vector\data'

sources:
  windows_security:
    type: exec
    command:
      - powershell
      - -Command
      - >
        [Console]::OutputEncoding = [Text.UTF8Encoding]::UTF8; 
        wevtutil qe Security /f:xml /q:"*[System[(EventID=4625 or EventID=4624)]]"
    mode: scheduled
    scheduled:
      exec_interval_secs: 3

sinks:
  file_logon_events:
    type: file
    inputs:
      - windows_security
    path: 'C:\Users\admin\Documents\windows_logon_events.xml'
    encoding:
      codec: text
